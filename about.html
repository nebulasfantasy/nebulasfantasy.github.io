<!DOCTYPE html>
<html>
<title>Nebulas Fantasy</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karma">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/NF.css" rel="stylesheet">
<style>
        img {
            display:block;
            margin:auto;
        }
        .sectionTitle {
        font-weight: bold;
        padding: 20px; 
    }
    ul{
        font-size:16pt;
    }
    .content{
        font-size:16pt;
        padding: 20px;
        margin-bottom: 30px 
    }
</style>
<body>

    <div class="container">
        <div class="w3-white w3-xlarge" style="max-width:1200px;">
                <div class="w3-bar">
                        <a href="./index.html" class="w3-bar-item w3-button">Home</a>
                        <a href="./Avatars.html" class="w3-bar-item w3-button">Portfolio</a>
                        <a href="./market.html" class="w3-bar-item w3-button">Market</a>
                        <a href="./about.html" class="w3-bar-item w3-button">About</a>
                        <a href="" id="contractAddress" class="w3-bar-item w3-button">Contract</a>
                        <a href="./ch/about.html" class="w3-bar-item w3-button" style="float:right">中文</a>
                        <span class="w3-bar-item" id="pool" style="float:right"></span>
                </div>
        </div>

        <header class="w3-display-container w3-content w3-wide" style="max-width:1600px" id="home">
            <img class="w3-image" src="./img/banner0.png">
        </header>



        <div class=class="w3-main w3-content w3-padding" style="max-width:1200px;margin-top:100px">
            <h2 class="sectionTitle"> What is Nebulas Fantasy</h2>
            <div class="content">
                <p> Nebulas Fantasy is a decentralized application that operates on the Nebulas Network. We setup a fantasy platform for everyone to enjoy the Russian World Cup 2018 in a unique manner. 
                    You can claim Avatars of popular soccer stars on Nebulas blockchain, accumulate points according to the their performance in the real World Cup match-ups, and reward NAS as prize!</p>
            </div>
           
    
            <br>
            <h2 class="sectionTitle"> How to play Nebulas Fantasy</h2>
            <ul>
                <li>Step1: Claim ownership of an Avatar on Nebulas blockchain. The amount of NAS as claim payment will enter the total prize pool.</li>
                <li>Step2: Avatars accumulate experience points based on their performance in the real World Cup games.</li>
                <li>Step3: After the World Cup ends on 07/15/18, Avatars with top 50 highest points share the total prize.</li>
                <li>Extra: During the World Cup, you can transfer your avatar to your friends for free. A trading market will be supported shortly</li>
            </ul>

            <br>
            <h2 class="sectionTitle"> What is an Avatar</h2>
            <div class="content">
                <p> An "Avatar" in Nebulas Fantasy is a NRC721 token on Nebulas blockchain. Once claimed, the Avatar (or this NRC721 token) will be associated with your NAS address, and stored on the Nebulas Blockchain. </p>
                <p> There are two ways to claim an Avatar: 
                    <ul>
                        <li> Spend a little NAS to claim a random Avatar <a href="./index.html" target="_blank"> on home page</a> </li>
                        <li> Pay a premium for a specific Avatar on the <a href="./market.html" target="_blank"> market</a></li>
                    </ul>
                <p> General rules about Avatars specified on Nebulas smart contract</p>
                <ul>
                    <li> You can claim Avatars through the World Cup, but your Avatar won’t be able to receive points before the Avatar is generated. </li>   
                    <li> Each Avatar is generated with a talent value (i.e. 1-5). For the same performance, an Avatar with a higher talent score more points.</li>
                    <li> For every 50 Avatars generated via lottery, the lottery price will increase by 0.1NAS. </li>
                    <li> For every specific Avatar generated via open market, the price for that specific Avatar will increase by 0.02NAS. </li>
                    <li> For every minute an Avatar plays, he will score 1 points x his talent. </li>
                    <li> For every winning game an Avatar participates, he will score 100 pts; </li>
                    <li> For every goal an Avatar scores, he will get 300 pts </li>
                    <li> The total score of an Avatar  = minutes he played * talent + # of winning game * 100 + # of goals * 300 </li>
                </ul>
            </div>

            <br>
            <h2 class="sectionTitle"> Reward Rule</h2>
            <div class="content">
                    <p> After the World Cup ends on 7/15, Avatars will be ranked according to the points and the total prize pool will distribute NAS to the winning Avatar owners. </p>
                    <p> Following reward distribution rules have been specified in the Nebulas smart contract</p>
                    <ul>
                            
                            <li> The top 3 Avatars will receive 25%,15% and 10% of the total prize pool, correspondingly. </li>   
                            <li> The 4-10th Avatars will evenly share 15% of prize pool.</li>
                            <li> The 11-30th Avatars will evenly share 15% of prize pool.</li>
                            <li> The 31-50th Avatars will evenly share 10% of prize pool.</li>
                            <li> The Nebulas Fantasy Team will get 10% of the total prize pool as maintenance fee.</li>
                    </ul>
            
            </div>
  
        </div>


          
        <footer class="w3-container w3-padding-64 w3-center w3-large"> 
            <p>Powered by Nebulas Fantasy Team</p>
            <p>nebulas.fantasy@gmail.com</p>
        </footer>

  
 

<!-- End page content -->
</div>
<script src=lib/jquery-3.3.1.min.js></script>
<script src= "bootstrap.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src=lib/nebpay.js></script>
<script src=lib/nebulas.js></script>
<script src='address.js'></script>

<script>
        var nebulas = require("nebulas"),
        neb = new nebulas.Neb();
        var NebPay = require("nebpay");
        var nebPay = new NebPay();
        var serialNumber;
        Account = nebulas.Account;
        var account;

        var mainnetUrl = "https://pay.nebulas.io/api/mainnet/pay",
        testnetUrl = "https://pay.nebulas.io/api/pay";

        var ownerAddress;
        var explorerTex, explorer, chainId, callbackUrl, NebHttpRequest;    

        if(mainnet==false){ // test net
            // const contractAddress =  require("address");//"n1wtjL3KMVNTV3gsWhJibnNMmr6HJHKwBW2";
            ownerAddress = "n1RQYWMLqy1twJhfYxPk4SFx7wdfeq31pMX";
            NebHttpRequest = "https://testnet.nebulas.io";
            chainId = 1001;// test net
            callbackUrl = testnetUrl;
            explorerTx = "https://explorer.nebulas.io/#/testnet/tx/";
            explorer = "https://explorer.nebulas.io/#/testnet/address/";
        }else
        {
            // //main net 
            ownerAddress = "n1bveJ8tkb1DDECgHvknRFZesJqeaL2iKNt";
            NebHttpRequest = "https://mainnet.nebulas.io";
            chainId = 1;// mainnet net
            callbackUrl = mainnetUrl;
            explorerTx = "https://explorer.nebulas.io/#/mainnet/tx/";
            explorer = "https://explorer.nebulas.io/#/mainnet/address/";
        }

            neb.setRequest(new nebulas.HttpRequest(NebHttpRequest));
            $("#contractAddress").attr('href', explorer + contractAddress).attr('target', "_blank");
   

   



//         function buy() {
//             var to = contractAddress;
//             var value = 0;// need to change
//             var callFunction = "mint";
//             var callArgs = "";
//             serialNumber = nebPay.call(to, value, callFunction, callArgs, {    //使用nebpay的call接口去调用合约,
//                 listener: mintListener,        //设置listener, 处理交易返回信息
//             });
//         }

//         var txhash;

//         function mintListener(resp) {
//             txhash = resp.txhash;
//             neb.api.getTransactionReceipt({
//                 hash: resp.txhash
//             })
//                 .then(function (receipt) {
//                     console.log("receipt is:" + JSON.stringify(receipt))
//                     setQuery = setInterval(function () {
//                         setTxQuery();
//                     }, 10000);
//                 })
//         }

//             function setTxQuery() {
//             neb.api.getTransactionReceipt({
//                 hash: txhash
//             })
//                 .then(function (receipt) {
//                     console.log(receipt)
//                     if (receipt.status ==1){
//                         console.log("tx success")
//                         var AvatarId = JSON.parse(receipt.execute_result);
//                         console.log(AvatarId)
//                         loadAvatarPicsById(AvatarId);
//                         clearInterval(setQuery);
//                     }

//                    if (receipt.status ==0){
//                         console.log("tx fail")
//                         clearInterval(setQuery);
//                     }
                    
//                 })
//                 .catch(function (err) {
//                     console.log("didn't get a receipt")
//                 })
//         }

    function init(){
        console.log("in the initial function");
        getTotalPrize();        
    }


       var temp
        
        // check the prize pool
        function getTotalPrize() {
                var testcontract;
                var callJSONs = {
                    from: ownerAddress, // get address string
                    to: contractAddress, // get the contract string
                    value: "0",
                    nonce: 0,
                    gasPrice: "200000",
                    gasLimit: "1000000",
                    contract: testcontract
                }

                // get the token Id owned by the address
                testcontract = { "function": "getPrizePool", "args": "" };
                callJSONs.contract = testcontract;
                neb.api.call(callJSONs)
                .then(function (resp){
                    
                    // $("#prize").show().text("Total prize pool:  " + String(parseInt(JSON.parse(resp.result)) / 1e18) + " NAS");
                    $("#pool").show().text(String(parseInt(JSON.parse(resp.result)) / 1e18) + " NAS in pool");
                    }   
                )
        };

        
        $(window).load(function () {
            // executes when complete page is fully loaded, including all frames, objects and images
                window.postMessage({
                "target": "contentscript",
                "data":{},
                "method": "getAccount",
                }, "*");
     
                window.addEventListener('message', function(e) {
                    if(!!e.data.data.account){
                        account = e.data.data.account;
                    } 
                    // console.log(account)
                });  
                
                init();
        });
    </script>

</body>
</html>
